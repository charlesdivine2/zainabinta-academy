<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zainabinta Academy - Admin Portal</title>

<link rel="stylesheet" href="style.css">

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>

<script src="firebase-config.js"></script>
</head>

<body class="admin-bg">

<!-- HEADER -->
<header class="top-bar">
    <div class="logo-title">
        <img src="logo.png" class="small-logo">
        <h2>ZAINABINTA ACADEMY - Admin</h2>
    </div>
    <button onclick="logout()" class="logout-btn">Logout</button>
</header>

<!-- LOGIN SECTION -->
<div id="loginSection" class="center-card">
    <h3>Admin Login</h3>
    <input type="email" id="adminEmail" placeholder="Admin Email">
    <input type="password" id="adminPassword" placeholder="Password">
    <button onclick="adminLogin()">Login</button>
</div>

<!-- DASHBOARD -->
<div id="adminDashboard" style="display:none;" class="dashboard">

    <h3>Create Student Account</h3>
    <input type="text" id="studentName" placeholder="Student Full Name">
    <input type="email" id="studentEmail" placeholder="Student Email">
    <input type="password" id="studentPassword" placeholder="Temporary Password">

    <select id="studentClass">
        <option>Primary 2</option>
        <option>Primary 3</option>
        <option>Primary 4</option>
        <option>Primary 5</option>
        <option>Primary 6</option>
        <option>JSS1</option>
        <option>JSS2</option>
        <option>JSS3</option>
        <option>SS1</option>
        <option>SS2</option>
        <option>SS3</option>
    </select>

    <button onclick="createStudent()">Create Student</button>

</div>

<script>

const ADMIN_UID = "i9a6Rex1V0MujP1AigQYt48jyE82";

function adminLogin(){
    const email = document.getElementById("adminEmail").value;
    const password = document.getElementById("adminPassword").value;

    firebase.auth().signInWithEmailAndPassword(email, password)
    .then((userCredential) => {
        const user = userCredential.user;

        if(user.uid === ADMIN_UID){
            document.getElementById("loginSection").style.display = "none";
            document.getElementById("adminDashboard").style.display = "block";
        } else {
            alert("Access Denied!");
            logout();
        }
    })
    .catch((error) => {
        alert(error.message);
    });
}

function createStudent(){
    const name = document.getElementById("studentName").value;
    const email = document.getElementById("studentEmail").value;
    const password = document.getElementById("studentPassword").value;
    const studentClass = document.getElementById("studentClass").value;

    firebase.auth().createUserWithEmailAndPassword(email, password)
    .then((userCredential) => {
        const user = userCredential.user;

        return firebase.firestore().collection("students").doc(user.uid).set({
            name: name,
            email: email,
            class: studentClass,
            createdAt: new Date()
        });
    })
    .then(() => {
        alert("Student Created Successfully");
    })
    .catch((error) => {
        alert(error.message);
    });
}

function logout(){
    firebase.auth().signOut().then(() => {
        window.location.href = "index.html";
    });
}

</script>

</body>
</html>
